---
layout: post
title: "BLD-120MM-PACK Complete Robot Build Instructions"
author: iliao
categories: [Arduino, ESP32, BLD-120MM-PACK, BLDC-30P]
image: assets/images/webp/BLD-120MM-PACK_assembled_robot_front_left.webp
featured: true
hidden: true
# comments: false
# tags: [red, yellow]
# rating: .5
---

Here are the most up-to-date and the most complete instructions to build, set up, bring up and operate Maker's Pet [BLD-120MM-PACK](https://makerspet.com/store#!/120mm-Robot-Build-Pack/p/725772983) robot build pack with [BDC-30P](https://makerspet.com/store#!/Driver-Board-for-ESP32-DOIT-DevKit-V1-Brushed-DC-Motors-and-LiDAR/p/724227009) driver board.

## Robot Assembly Instructions
<div class="text-center">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/6GtjAB19GP8"
        title="BLD-120MM-BACK robot body assembly with BDC-30P driver board" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;
        picture-in-picture; web-share" allowfullscreen>
    </iframe>
</div>
<p></p>

## PC Software Setup Instructions

TODO 2/2025

## Robot Bring-up Instructions

- [config.yaml](https://github.com/makerspet/store/blob/main/MINI-BDC30P-BODY/v1.0.0/config_bdc_30p.yaml) for BLD-120MM-PACK with a BDC-30P driver board. BDC-30P accepts ESP32 DOIT DevKit v1 dev board.

<div class="text-center">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/IOQBNl0O_tI"
        title="Arduino/ROS2 Lidar robot - software setup" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;
        picture-in-picture; web-share" allowfullscreen>
    </iframe>
</div>
<p></p>

## Robot Operation Instructions

TODO 2/2025

## FAQ and Troubleshooting

### How do I Troubleshoot the Robot

Watch Maker's Pet YouTube videos for troubleshooting tips.

- Debug ESP32-related issues using the Arduino Serial Monitor.
  - Connect ESP32 dev board to your PC
  - Open the Arduino Serial Monitor.
  - Make sure your Serial Monitor baud rate is set to 115200.
  - Inspect the Serial Monitor output.
  - Press the ESP32 reset (EN) button to reboot ESP32.

- Debug ROS2-related issues using ROS2 tools
  - Inspect the command shell output.
  - Read ROS2 documentation.

### 'docker run' Fails on Windows PC

```
PowerShell 7.5.0
PS C:\Users\ilya> docker run --name makerspet -it --rm -p 8888:8888/udp -p 4430:4430/tcp -e DISPLAY=host.docker.internal:0.0 -e LIBGL_ALWAYS_INDIRECT=0 kaiaai/kaiaai:iron
docker: error during connect: Head "http://%2F%2F.%2Fpipe%2FdockerDesktopLinuxEngine/_ping": open //./pipe/dockerDesktopLinuxEngine: The system cannot find the file specified.
See 'docker run --help'.
PS C:\Users\ilya>
```

Looks like your Docker engine is not running. Launch Docker Desktop on your Windows PC.

### 'docker run' Fails on Windows PC

```
PowerShell 7.5.0
PS C:\Users\ilya> docker run --name makerspet -it --rm -p 8888:8888/udp -p 4430:4430/tcp -e DISPLAY=host.docker.internal:0.0 -e LIBGL_ALWAYS_INDIRECT=0 kaiaai/kaiaai:iron
docker: Error response from daemon: Ports are not available: exposing port TCP 0.0.0.0:4430 -> 0.0.0.0:0: listen tcp 0.0.0.0:4430: bind: An attempt was made to access a socket in a way forbidden by its access permissions.
PS C:\Users\ilya>
```

Try rebooting your Windows PC.

### ROS2 GUI not Showing on Windows PC

Make sure you have launched the X server on your Windows PC.

### Robot's ESP32 Fails to Connect to WiFi

- Make sure the WiFi credentials you provided to your ESP32 during the web config are correct.
- Try pressing the reset (EN) button on your ESP32.
This often fixes WiFi connection failure problems as long as the WiFi has been configured correctly.
- Make sure your WiFi is 2.4GHz - NOT 5GHz. ESP32 supports 2.4GHz WiFi only.
- Do the "factory" reset (see this FAQ) followed by the web WiFi config.
Make sure the WiFi credentials you provide to your ESP32 are correct.

### Robot's ESP32 Connects to WiFi, but Fails to Connect to the Windows ROS2 PC

- Make sure you have launched the `kaiaai/kaiaai:iron` image in Docker
- Inside the Docker container running the `kaiaai/kaiaai:iron` image, make sure you have launched `ros2 launch kaiaai_bringup physical.launch.py`
- Make sure both your robot and your PC are connected to the same local WiFi network
- Make sure your local WiFi network allows devices to connect to each other and does not block ports. For example, WiFi networks in cafes, restaurants often block local-device-to-local-device connections.
- Make sure your PC does not block incoming local connections.

### How to Perform the "Factory" Reset

- Power up your ESP32 dev board (e.g. using USB or battery power)
- Press the reset (EN) button on your ESP32 dev board
- Within 1 second or less, press and hold the BOOT button on your ESP32 dev board
The ESP32 activity LED should start blinking very fast
- Keep pressing the BOOT button for a few seconds until the ESP32 activity LED turns solid on.
- Release the BOOT button. Your ESP32 should reboot and restart in the AP (WiFi configuration) mode.

### Arduino IDE Fails to Detect ESP32 COM Port

- Make sure your ESP32 is powered up and its power LED indicator is on.
- Check if your ESP32-to-PC USB cable is damaged. Try replacing your USB cable.
- Check if your ESP32-to-PC USB cable is for CHARGING ONLY. Try replacing your USB cable with a regular one.
- Sometimes ESP32 dev board's USB-to-serial hardware can fail.
  - Try connecting your ESP32 to another PC.
  - Try connecting another ESP32 to your PC.

### ESP32 Serial Monitor Output

Here is a serial monitor dump of ESP32 booting, reading configuration files, connecting to WiFi and successfully connecting to the ROS2 PC. The battery power switch is OFF in this case.

```
ets Jul 29 2019 12:21:46

rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:1
load:0x3fff0030,len:1344
load:0x40078000,len:13964
load:0x40080400,len:3600
entry 0x400805f0

Kaia.ai firmware version 0.8.0-iron
ESP IDF version v4.4.7-dirty
SPIFFS mounted successfully
/network.yaml found; loaded OK
/config.yaml found; loaded OK
To enter web config push-and-release EN, then push-and-hold BOOT within 1 sec
Board model BDC-30P, version v1.1.0, manufacturer makerspet.com
LIDAR model LDROBOT LD14P
LIDAR RX buffer size 1024, baud rate 230400
Battery ADC attenuation 7.00, voltage 0.99V
Motor driver type IN1_IN2; motor encoder type AB_QUAD
Motor Max RPM 180.00; encoder PPR 1035.00 TPR 4140.00

Connecting to WiFi NETGEAR48 ... connected, IP 192.168.1.5
Connecting to Micro-ROS agent 192.168.1.113 ... success
Syncing time ... OK
UTC time Tue Feb 11 23:02:53 2025
micro-ROS client key 0xDD9181CC; ROS2 node /pet
Micro-ROS initialized
LiDAR info Model: LDROBOT LD14P
startLIDAR() result: OK

Telem avg 106 max 5667ms, LiDAR RPM 0.00, wheels RPM 0.00 0.00, battery 0.99V, RSSI -59dBm
Telem avg 50 max 51ms, LiDAR RPM 0.00, wheels RPM 0.00 0.00, battery 0.99V, RSSI -59dBm
Telem avg 50 max 51ms, LiDAR RPM 0.00, wheels RPM 0.00 0.00, battery 0.99V, RSSI -58dBm
```

### Power consumption

Conditions:
- 9V battery, power switch ON
- connected to ROS2 PC over WiFi
- ESP32 with USB-C
- LDROBOT LD14P LiDAR operating
- two 12V N20 motors
- ESP32 USB disconnected from PC
- Kaia.ai firmware version 0.8.0-iron

Battery current draw:
- around 240ma both motors off
- around 430-450ma both N20 motors full on, spinning freely
